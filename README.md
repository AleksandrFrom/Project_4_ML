## Содержание

[[1. О проекте](https://github.com/AleksandrFrom/Project_4_ML/edit/main/README.md)
[[2. Какая задача решается](https://github.com/AleksandrFrom/Project_4_ML/edit/main/README.md)
[[3. Краткая информация о данных](https://github.com/AleksandrFrom/Project_4_ML/edit/main/README.md)
[[4. Этапы работы над проектом](https://github.com/AleksandrFrom/Project_4_ML/edit/main/README.md)
[[5. Результаты](https://github.com/AleksandrFrom/Project_4_ML/edit/main/README.md)
[[6. Выводы](https://github.com/AleksandrFrom/Project_4_ML/edit/main/README.md)

____
### О проекте
Предоставилены данные о последней маркетинговой кампании, которую проводил банк: задачей было привлечь клиентов для открытия депозита. 
Необходимо проанализировать эти данные, выявить закономерность и найти решающие факторы, повлиявшие на то, что клиент вложил деньги именно в этот банк.

### Какая задача решается
Бизнес-задача: определить характеристики, по которым можно выявить клиентов, более склонных к открытию депозита в банке, и за счёт этого повысить результативность маркетинговой кампании.

Техническая задача: построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать, воспользуется он предложением об открытии депозита или нет.

### Краткая информация о данных
Представлены данные о клиентах банка и результатах маркетинговых компаний, проводимых среди клиентов банка.

### Этапы работы над проектом
1. Первичная обработка данных.
    Обработка пропусков и выбросов в данных.
2. Разведывательный анализ данных (EDA).
    Исследование данных, поиск первых закономерностей. Формирование гипотез.
3. Отбор и преобразование признаков.
    Перекодировка и преобразование данных таким образом, чтобы их можно было использовать при решении задачи классификации.
4. Решение задачи классификации: логистическая регрессия и решающие деревья.
    На данном этапе строится прогностическая модель и оценивается её качество. Подбираются оптимальные параметры модели для того, чтобы получить наилучший результат для конкретного алгоритма.
5. Решение задачи классификации: ансамбли моделей и построение прогноза.
    Доработка предсказания с использованием более сложных алгоритмов и оценка, с помощью какой модели возможно сделать более качественные прогнозы.
  
### Результаты
1. Исследованы данные. 
    В признаке balance выявлено 25 пропусков. 
    В признаке job выявлены пропуски обозначенные как unknow.
    Признак balance приобразован в вещественное число float.
    Обработаны пропуски в категориальных признаках: job и education и заменены на модальные значения.
    Определены границ выброса для параметра balance. Выбросы удалены, согласно определенным границам.
2. Разведывательный анализ.
    Изучено соотношение классов в данных на предмет несбалансированности.
    Проведен рассчет описательной статистики для количественных переменных.
    Сделана визуализации зависимости признаков deposit и balance от различных факторов.
    Определено,что наличие deposit в большей степени зависит от balance. Логично предположить, что это свяазно с тем, что у клиентов есть больше свободных средств, которые они могут положить на депозит.
    Проведен рассчет описательной статистики для категориальных переменных. Сделана визуализация зависимостей.
    Созданы возрастные группы в переменной age для определения, в каких группах более склонны открывать депозит.
3. Преобразование данных.
    Проведено преобразование переменных age, education.
    Преобразованы бинарные переменные: deposit, default, housing, loan.
    Созданы dummie-переменные: marital, job, contact, poutcome, month.
    Построена корреляционная матрица для оценки данных на предмет наличия мультиколлинеарности. 
    Порог мультиколлинеарности - 0,9.
    Создание выборок для обучения моделей.
    С помощью SelectKBest выбраны 15 параметров, по которым будет обучаться модель.
    Создан набор данных из 15 параметров и проведено масштабирование данных для дальнейшего использования при обучении моделей.
4. Решение задачи классификации: логистическая регрессия и решающие деревья.
    Обучена логистическа регрессия и проведен рассчет метрики качества.
    Обучена модель решающих деревьев, проведена настройка максимальной глубины.
    Проведен подбор оптимальных параметров для решающих деревьев с помощью gridsearch.
5. Решение задачи классификации: ансамбли моделей и построение прогноза.
    Обучение на полученных данных модели случайный лес.
    Обучена модель градиентного бустинга для классификации для сравнения со случайным лесом.
    Составлен стекинг из уже известных алгоритмов.
    Проведена оптимизация гиперпараметров с помощью Optuna.
    С использованием оптимизрованных гиперпараметров обучена модель случайный лес. 
    Получено повышение метрик f1 и accuracy на тестовых выборках.

### Выводы
Проведенный анализ данных помог выявить и устранить пропуски. 
Были определены основные параметры влияющие на конечный выбор клиентов при открытии депозита.
Было обучено несколько моделей. Наилучший результат был показан на модели Случайный лес.
Также при оптимизации гиперпараметров модели Случайный лес метрики были незначительно улучшены, но они остались на уровне, достигнутом при составлении Стекинга. f1 - 0.82, accuracy - 0.83. 
